## Lab: Creating Routes by Exposing Services

### Application description
// [silver]#In this lab, we're going to make our application visible to the end users, so they can access it.#

この演習では、アプリケーションにエンドユーザがアクセスできるようにしていきます。

image::roadshow-app-architecture-parksmap-2.png[Application architecture,800,align="center"]

### Background: Routes

// [silver]#While *Services* provide internal abstraction and load balancing within an OpenShift environment, sometimes clients (users, systems, devices, etc.) **outside** of OpenShift need to access an application. The way that external clients are able to access applications running in OpenShift is through the OpenShift routing layer. And the data object behind that is a *Route*.#

*Service* は、OpenShift 内の抽象化とロードバランスを提供しますが、**OpenShiftの外側** のクライアントからはアクセスできません。アプリケーションを外部からアクセスするためのには　Routing Layer を経由します。Routing Layer を経由して外部からアクセス可能にするための定義は *Route* で行います。

// [silver]#The default OpenShift router (HAProxy) uses the HTTP header of the incoming request to determine where to proxy the connection. You can optionally define security, such as TLS, for the *Route*. If you want your *Services*, and, by extension, your *Pods*,  to be accessible to the outside world, you need to create a *Route*.#

デフォルトのOpenShift の Router は　HAProxy のコンテナを利用しています。HTTPヘッダーを見て、どのサービスに連携するかを決定します。


#### Exercise: Creating a Route

// [silver]#Fortunately, creating a *Route* is a pretty straight-forward process.  You simply `expose` the *Service* via the command line. Or, via the web console, just click the "Create Route" button associated with the service.#

*Route* の作成は非常に簡単です。 あなたは単にコマンドラインで`expose` *Service* とするだけ。または、web コンソール経由で `Create route` のリンクをクリックするだけです。

// [silver]#First we want to verify that we don't already have any existing routes:#

まず、既存のルートがないことを確認します。

[source]
----
$ oc get routes
No resources found.
----

// [silver]#Now we need to get the *Service* name to expose:#

公開する *Service* の名前を確認します。

[source]
----
$ oc get services

NAME       CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE
parksmap   172.30.169.213   <none>        8080/TCP   5h
----

// [silver]#Once we know the *Service* name, creating a *Route* is a simple one-command task:#

*Services* 名がわかってしまえば、*Route* の作成は1行コマンドで実行可能です。

[source]
----
$ oc expose service parksmap
route "parksmap" exposed
----

// [silver]#Verify the *Route* was created with the following command:#

次のコマンドで、作成された *Route* を確認します。

[source]
----
$ oc get route
NAME       HOST/PORT                                              PATH      SERVICES   PORT       TERMINATION
parksmap   parksmap-{{EXPLORE_PROJECT_NAME}}{{USER_SUFFIX}}.{{ROUTER_ADDRESS}}             parksmap   8080-tcp
----

// [silver]#You can also verify the *Route* by looking at the project in the OpenShift web console:#

OpenShift web コンソールでプロジェクトを見ることによって *Route* を確認することができます。

image::parksmap-route.png[Route]

// [silver]#Pretty nifty, huh?  This application is now available at the URL shown in the web console. Click the link and you will see:#

かなり気が効いてるでしょ? このアプリケーションは、web コンソールに表示される URL で利用できるようになりました。リンクをクリックすると表示されます:

image::parksmap-empty.png[Route]
